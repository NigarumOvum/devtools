---
import Layout from "../layouts/Layout.astro";
import { getLangFromUrl, useTranslations } from "../utils/i18n";
import { getSession } from "auth-astro/server";
import AccountSettings from "../components/AccountSettings";

const session = await getSession(Astro.request);
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

if (!session) {
    return Astro.redirect("/");
}
---

<Layout title={t("account.pageTitle")}>
    <main class="min-h-screen pt-20 transition-all duration-300">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <!-- Breadcrumbs -->
            <nav class="flex items-center gap-2 text-sm text-slate-500 mb-8">
                <a href="/" class="hover:text-blue-500 transition-colors"
                    >{t("account.breadcrumbHome")}</a
                >
                <span>/</span>
                <span class="text-slate-900 dark:text-white font-semibold"
                    >{t("account.breadcrumbSettings")}</span
                >
            </nav>

            <div class="mb-10">
                <h1
                    class="text-3xl font-black text-slate-900 dark:text-white mb-2 tracking-tight"
                >
                    {t("account.title")}
                </h1>
                <p class="text-slate-500">{t("account.subtitle")}</p>
            </div>

            <AccountSettings client:load session={session} lang={lang} />
        </div>
    </main>
</Layout>
